<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simple AR Cube Placer</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <style>
    #arButton {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 20px;
      background: #4285f4;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      z-index: 999;
      cursor: pointer;
    }
    
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      font-family: Arial, sans-serif;
      z-index: 1000;
      text-align: center;
      padding: 20px;
    }
    
    .overlay h2 {
      margin-bottom: 20px;
    }
    
    .overlay p {
      margin-bottom: 30px;
      max-width: 600px;
    }
    
    .overlay button {
      padding: 12px 24px;
      background: #4285f4;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div id="startOverlay" class="overlay">
    <h2>Simple AR Cube Placement</h2>
    <p>This demo places a rotating red cube 1.5 meters (5 feet) in front of you when you tap the button. The cube will stay fixed in real-world space.</p>
    <button id="startButton">Start AR Experience</button>
  </div>

  <a-scene id="scene" embedded>
    <a-entity id="rig">
      <a-entity id="camera" camera look-controls position="0 1.6 0"></a-entity>
    </a-entity>
    
    <a-entity light="type: ambient; color: #BBB"></a-entity>
    <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="-0.5 1 1"></a-entity>
  </a-scene>
  
  <button id="arButton" style="display: none;">PLACE A CUBE HERE</button>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const startButton = document.getElementById('startButton');
      const startOverlay = document.getElementById('startOverlay');
      const arButton = document.getElementById('arButton');
      const scene = document.getElementById('scene');
      const camera = document.getElementById('camera');
      
      let cubeCount = 0;
      
      // Start AR experience
      startButton.addEventListener('click', function() {
        startOverlay.style.display = 'none';
        arButton.style.display = 'block';
      });
      
      // Place cube button
      arButton.addEventListener('click', function() {
        cubeCount++;
        
        // Get camera position and rotation
        const camPosition = camera.getAttribute('position');
        const camRotation = camera.getAttribute('rotation');
        
        // Convert camera's Y rotation to radians
        const rotationY = camRotation.y * (Math.PI / 180);
        
        // Calculate position 5 feet (1.5 meters) in front of camera
        const distance = 1.5;
        const xPosition = camPosition.x - Math.sin(rotationY) * distance;
        const zPosition = camPosition.z - Math.cos(rotationY) * distance;
        
        // Create a cube
        const cube = document.createElement('a-box');
        cube.setAttribute('id', `cube-${cubeCount}`);
        cube.setAttribute('position', `${xPosition} ${camPosition.y} ${zPosition}`);
        cube.setAttribute('color', 'red');
        cube.setAttribute('width', '0.5');
        cube.setAttribute('height', '0.5');
        cube.setAttribute('depth', '0.5');
        cube.setAttribute('animation', 'property: rotation; to: 0 360 0; loop: true; dur: 8000; easing: linear');
        
        // Add cube to scene
        scene.appendChild(cube);
        
        // Update the button text
        arButton.textContent = `PLACED CUBE ${cubeCount} - TAP FOR MORE`;
        
        console.log(`Cube ${cubeCount} placed at position:`, xPosition, camPosition.y, zPosition);
      });
    });
  </script>
</body>
</html>