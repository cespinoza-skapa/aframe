<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>AR Cube Scene 2</title>
<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
<script>
  // Function to get current location
  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        function(position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          
          // Calculate position 5 feet (approx 1.5 meters) away
          // At Earth's surface, 1 degree of latitude is ~111,000 meters
          // Placing the cube 5 feet (~1.5m) north of current position
          const distanceInDegrees = 1.5 / 111000; // 5 feet in degrees latitude
          
          // Create the cube at 5 feet away from current location
          const cube = document.createElement('a-entity');
          cube.setAttribute('gps-entity-place', {
            latitude: latitude + distanceInDegrees, // Place it slightly north of user
            longitude: longitude
          });
          cube.setAttribute('geometry', 'primitive: box');
          cube.setAttribute('material', 'color: #4CC3D9');
          cube.setAttribute('scale', '1 1 1'); // Smaller scale to look appropriate at 5 feet
          
          // Add the cube to the scene
          const scene = document.querySelector('a-scene');
          scene.appendChild(cube);
          
          // Update camera position
          const camera = document.querySelector('[camera]');
          camera.setAttribute('gps-camera', {
            latitude: latitude,
            longitude: longitude
          });
          
          alert('Cube placed 5 feet away at: ' + (latitude + distanceInDegrees) + ' ' + longitude);
        },
        function(error) {
          console.error('Error getting location:', error);
          alert('Unable to get your location. Please enable location services and try again.');
        }
      );
    } else {
      alert('Geolocation is not supported by your browser.');
    }
  }
</script>
</head>
<body style="margin: 0; overflow: hidden;">
<a-scene 
  embedded 
  arjs="sourceType: webcam; debugUIEnabled: true; detectionMode: mono;"
  renderer="logarithmicDepthBuffer: true;"
  vr-mode-ui="enabled: false">
  
  <!-- Camera with GPS controls -->
  <a-camera gps-camera rotation-reader></a-camera>
  
  <!-- Lighting -->
  <a-entity light="type: ambient; color: #BBB"></a-entity>
  <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="-0.5 1 1"></a-entity>
</a-scene>

<script>
  // Get location when the page loads
  window.onload = getLocation;
</script>
</body>
</html>