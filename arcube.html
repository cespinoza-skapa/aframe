<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>AR Cube with Marker</title>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>
    .info-panel {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 10px;
      font-family: Arial, sans-serif;
      z-index: 999;
      border-radius: 5px;
      max-width: 300px;
    }
    
    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
      font-family: Arial, sans-serif;
      z-index: 1000;
      text-align: center;
      padding: 20px;
    }
    
    .overlay h2 {
      margin-bottom: 20px;
    }
    
    .overlay p {
      margin-bottom: 20px;
      max-width: 600px;
    }
    
    .overlay img {
      max-width: 80%;
      margin: 20px 0;
      border: 2px solid white;
    }
    
    .overlay button {
      padding: 12px 24px;
      background: #4285f4;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body style="margin: 0; overflow: hidden;">
  <div id="startOverlay" class="overlay">
    <h2>AR Cube with Fixed Position</h2>
    <p>This demo uses a marker to place cubes that truly stay fixed in real-world space.</p>
    <p>Display this marker on another device or print it:</p>
    <img src="https://raw.githubusercontent.com/AR-js-org/AR.js/master/data/images/hiro.png" alt="HIRO marker">
    <p>When the marker is detected, a cube will appear 5 feet (1.5m) above it.</p>
    <button id="startButton">Start AR Experience 2</button>
  </div>

  <!-- A-Frame Scene with AR.js -->
  <a-scene 
    embedded 
    arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
    renderer="logarithmicDepthBuffer: true;"
    vr-mode-ui="enabled: false">
    
    <!-- This is the marker we'll use -->
    <a-marker preset="hiro" id="marker">
      <!-- Base platform at the marker -->
      <a-box position="0 0.1 0" width="1" height="0.1" depth="1" color="yellow" opacity="0.5"></a-box>
      
      <!-- Cube 5 feet (1.5m) above the marker -->
      <a-entity id="cubeContainer" position="0 1.5 0">
        <a-box id="cube" 
          color="red" 
          width="0.5" 
          height="0.5" 
          depth="0.5"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 8000; easing: linear">
        </a-box>
        
        <!-- Line connecting marker to cube -->
        <a-entity line="start: 0 -1.5 0; end: 0 0 0; color: blue;"></a-entity>
      </a-entity>
      
      <!-- Text label -->
      <a-text value="5 feet above marker" position="0 1.8 0" align="center" color="white" scale="0.5 0.5 0.5"></a-text>
    </a-marker>
    
    <!-- Camera -->
    <a-entity camera></a-entity>
  </a-scene>

  <div class="info-panel" id="infoPanel" style="display: none;">
    Point the camera at the HIRO marker to see the cube.<br>
    The cube stays fixed in real-world space because it's anchored to the marker.
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const startButton = document.getElementById('startButton');
      const startOverlay = document.getElementById('startOverlay');
      const infoPanel = document.getElementById('infoPanel');
      const marker = document.getElementById('marker');
      const cube = document.getElementById('cube');
      
      // Start AR experience
      startButton.addEventListener('click', function() {
        startOverlay.style.display = 'none';
        infoPanel.style.display = 'block';
      });
      
      // Marker detection events
      marker.addEventListener('markerFound', function() {
        console.log('Marker found!');
        infoPanel.innerHTML = 'Marker detected! The cube is now placed 5 feet (1.5m) above it.';
      });
      
      marker.addEventListener('markerLost', function() {
        console.log('Marker lost!');
        infoPanel.innerHTML = 'Marker lost. Point the camera at the marker again.';
      });
      
      // Optional: Allow changing cube color by clicking on it
      cube.addEventListener('click', function() {
        const colors = ['red', 'blue', 'green', 'yellow', 'purple', 'orange'];
        const randomColor = colors[Math.floor(Math.random() * colors.length)];
        cube.setAttribute('color', randomColor);
      });
    });
  </script>
</body>
</html>