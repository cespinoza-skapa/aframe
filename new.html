<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR Box Interaction</title>
    <!-- A-Frame and AR.js Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.4.2/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        #popupMessage {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            max-width: 80%;
        }
        
        #closeButton {
            display: block;
            margin-top: 20px;
            padding: 8px 16px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        .a-enter-ar {
            font-size: 1.5em !important;
            padding: 0.5em 1em !important;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="popupMessage">
        <p>You've interacted with the 3D box!</p>
        <button id="closeButton">Close</button>
    </div>

    <!-- A-Frame Scene with AR.js -->
    <a-scene 
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        vr-mode-ui="enabled: false">
        
        <!-- Use a custom marker to place the box -->
        <a-marker-camera type="pattern" url="https://raw.githack.com/AR-js-org/AR.js/master/data/hiro.patt">
            <!-- The box will be positioned relative to this marker -->
        </a-marker-camera>
        
        <!-- Create a 3D box positioned 10 feet (about 3 meters) away -->
        <a-box 
            id="ar-box"
            position="0 0 -3"
            width="0.5" 
            height="0.5" 
            depth="0.5" 
            color="#4285F4"
            class="clickable"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear;">
        </a-box>
        
        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Wait for the scene to load
        document.addEventListener('DOMContentLoaded', function() {
            // Get a reference to the box
            const box = document.getElementById('ar-box');
            
            // Wait for A-Frame to initialize
            setTimeout(function() {
                // Add click event listener to the box
                box.addEventListener('click', showPopup);
                box.addEventListener('touchend', showPopup);
                
                console.log('Interaction handlers added to 3D box');
            }, 2000);
        });
        
        // Function to show the popup
        function showPopup() {
            const popup = document.getElementById('popupMessage');
            popup.style.display = 'block';
            
            // Add close button functionality
            document.getElementById('closeButton').addEventListener('click', function() {
                popup.style.display = 'none';
            });
        }
    </script>
</body>
</html>