<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebAR Box Interaction</title>
    
    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    
    <!-- AR.js -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
        #popupMessage {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 1000;
            text-align: center;
            max-width: 80%;
        }
        
        #closeButton {
            display: block;
            margin-top: 20px;
            padding: 8px 16px;
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
        }

        #debug {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
            z-index: 999;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <!-- Popup message -->
    <div id="popupMessage">
        <p>You've interacted with the 3D box!</p>
        <button id="closeButton">Close</button>
    </div>
    
    <!-- Debug panel -->
    <div id="debug">Status: Initializing...</div>
    
    <!-- A-Frame scene -->
    <a-scene 
        embedded
        arjs="sourceType: webcam; debugUIEnabled: false;"
        vr-mode-ui="enabled: false">
        
        <a-box 
            id="interactiveBox"
            position="0 0 -3"
            width="1" 
            height="1" 
            depth="1" 
            color="#4285F4"
            material="opacity: 0.8"
            animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear;">
        </a-box>
        
        <a-camera position="0 1.6 0"></a-camera>
    </a-scene>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const debugPanel = document.getElementById('debug');
            const box = document.getElementById('interactiveBox');
            const camera = document.querySelector('a-camera');
            const scene = document.querySelector('a-scene');
            
            // Update debug panel
            debugPanel.textContent = "Status: Scene loading...";
            
            // When scene is loaded
            scene.addEventListener('loaded', function() {
                debugPanel.textContent = "Status: Scene loaded. Box positioned at 3 meters in front.";
                
                // Add interactivity to the box
                box.addEventListener('click', handleBoxInteraction);
                box.addEventListener('touchend', handleBoxInteraction);
            });
            
            // Function to handle box interaction
            function handleBoxInteraction() {
                debugPanel.textContent = "Status: Box clicked!";
                showPopup();
            }
            
            // Function to show popup
            function showPopup() {
                const popup = document.getElementById('popupMessage');
                popup.style.display = 'block';
                
                // Close button functionality
                document.getElementById('closeButton').addEventListener('click', function() {
                    popup.style.display = 'none';
                    debugPanel.textContent = "Status: Popup closed.";
                });
            }
        });
    </script>
</body>
</html>